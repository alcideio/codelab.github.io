
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Alcide Advisor &#43; GitHub Actions</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
  <google-codelab codelab-gaid="0"
                  id="advisor-codelab-10"
                  title="Alcide Advisor &#43; GitHub Actions"
                  environment="web"
                  feedback-link="https://github.com/alcideio/pipeline">
    
      <google-codelab-step label="Welcome" duration="1">
        <p>In this tutorial we will learn about <strong>Alcide Kubernetes Advisor</strong>, and how we can integrate it with GitHub Actions to implement continuous security and cluster hygiene for one or more Kubernetes clusters.</p>
<p class="image-container"><img alt="Alcide Code-to-production security" style="width: 300.00px" src="img/c59ad84f35d9d39f.png"></p>
<p>Alcide Advisor is an agentless Kubernetes audit, compliance and hygiene scanner that&#39;s built to ensure a friction free DevSecOps workflows. Alcide Advisor can be plugged in early in the development process and before moving to production.</p>
<h3 is-upgraded>With Alcide Advisor, the security checks you can cover includes:</h3>
<ul>
<li>Kubernetes infrastructure vulnerability scanning.</li>
<li>Hunting misplaced secrets, or excessive privileges for secret access.</li>
<li>Workload hardening from Pod Security to network policies.</li>
<li>Istio security configuration and best practices.</li>
<li>Ingress Controllers for security best practices.</li>
<li>Kubernetes API server access privileges.</li>
<li>Kubernetes operators security best practices.</li>
<li>Deployment conformance to labeling, annotating, resource limits and much more ...</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Prerequisites" duration="5">
        <ul>
<li>An user account on <a href="https://github.com/" target="_blank">GitHub</a></li>
</ul>
<p class="image-container"><img alt="Alcide Code-to-production security" style="width: 800.00px" src="img/59db1bd85aca6cb1.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Create a new GitHub repository" duration="0">
        <p>Since GitHub Actions run automatically when you push to a repository, you&#39;ll have to create a new repository to add the action to. Please refer to the instructions <a href="https://help.github.com/en/github/getting-started-with-github/create-a-repo" target="_blank">here</a>.</p>
<p>Of course, if you prefer to use an existing repository that is possible as well.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Create a GitHub Action workflow" duration="10">
        <p>In this example below, we provide a GitHub Action that spins up a <code>KinD</code> kubernetes cluster and deploys an application (the notoriously insecure <code>WebGoat</code>) to it. Both <code>kubectl</code> and <code>advisor</code> connect to the cluster using the <code>kubeconfig</code> that automatically generated by the installer of the <code>KinD</code> cluster.</p>
<h2 is-upgraded>Your GitHub Actions workflow definition</h2>
<p>Now that we have a GitHub repository, let&#39;s create a new GitHub Actions workflow by following the instructions <a href="https://help.github.com/en/actions/configuring-and-managing-workflows/configuring-a-workflow#creating-a-workflow-file" target="_blank">here</a>, using the workflow definition below to be written to the <code>.github/workflows/main.yaml</code> path.</p>
<pre><code>name: CI

# Controls when the action will run. Triggers the workflow on push or pull request
# events but only for the master branch
on:
  push:
    branches: [ master ]

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  # This workflow contains a single job called &#34;build&#34;
  build:
    # The type of runner that the job will run on
    runs-on: ubuntu-latest

    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:
    # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
    - uses: actions/checkout@v2

    # Launches a KinD cluster to deploy our application under test to
    - name: Launch Cluster
      uses: engineerd/setup-kind@v0.3.0
    
    # Basic check that the cluster is up and running
    - name: Test cluster
      run: |
        kubectl cluster-info
        kubectl get pods -n kube-system

    # Deploy the application we want to scan to the cluster in a separate, new namespace
    - name: Deploy application to cluster
      run: |
        kubectl create namespace webgoat
        kubectl run --generator=run-pod/v1 webgoat --image=webgoat/webgoat-7.1 -n webgoat

    # Kick off the scan with Alcide Advisor
    - name: Scan Cluster
      uses: alcideio/advisor-action@v1.1.0   
      with:
        include_namespaces: &#39;webgoat&#39;
        output_file: &#39;advisor-scan.html&#39;

    # Upload the report to GitHub Action Artifacts
    - name: Upload Alcide Advisor Scan Report
      uses: actions/upload-artifact@v1
      with:
        name: advisor-scan.html
        path: advisor-scan.html
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="Run the workflow" duration="0">
        <p>By saving the workflow yaml, GitHub will automatically start running your workflow. Navigate to the output by clicking on the <code>&gt; Actions</code> header item on your main repository page.</p>
<p class="image-container"><img alt="Overview of running workflow" src="img/8defc9dc732a8db2.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Review the scan report" duration="0">
        <p>The GitHub Action will publish the scan results to <strong>Artifacts</strong>. In the top right corner of the workflow run, once the run is completed, there will be a <strong>Artifacts</strong> dropdown which you can download items from.</p>
<p class="image-container"><img alt="GitHub Actions artifacts link" style="width: 200.00px" src="img/bf948a1dd3c8e5a7.png"></p>
<p>The report will look like this:</p>
<p class="image-container"><img alt="GitHub Actions artifacts link" src="img/d9cffbc59acad700.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Summary" duration="1">
        <p>In this codelab we added an automated scan of an application on an kubernetes cluster as a step in your GitHub Actions workflow.</p>
<p class="image-container"><img alt="Alcide Code-to-production security" style="width: 400.00px" src="img/ef0ea234328b5e20.svg"></p>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/codelab-elements/native-shim.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/prettify.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/codelab-elements.js"></script>

</body>
</html>
